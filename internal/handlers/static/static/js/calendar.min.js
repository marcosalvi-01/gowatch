(()=>{(function(){function w(e){if(!e||e.hasAttribute("data-initialized"))return;e.setAttribute("data-initialized","true");let f=e.querySelector("[data-tui-calendar-month-display]"),p=e.querySelector("[data-tui-calendar-weekdays]"),y=e.querySelector("[data-tui-calendar-days]"),b=e.querySelector("[data-tui-calendar-prev]"),v=e.querySelector("[data-tui-calendar-next]"),U=e.closest("[data-tui-calendar-wrapper]"),h=U?U.querySelector("[data-tui-calendar-hidden-input]"):null;if(!f||!p||!y||!b||!v||!h){console.error("Calendar init error: Missing required elements (or hidden input relative to wrapper).",e);return}let D=e.getAttribute("data-tui-calendar-locale-tag")||"en-US",C;try{C=Array.from({length:12},(a,t)=>new Intl.DateTimeFormat(D,{month:"long",timeZone:"UTC"}).format(new Date(Date.UTC(2e3,t,1))))}catch(a){console.error(`Calendar: Error generating month names via Intl (locale: "${D}"). Falling back to English.`,a),C=["January","February","March","April","May","June","July","August","September","October","November","December"]}let I=["Su","Mo","Tu","We","Th","Fr","Sa"];try{I=Array.from({length:7},(a,t)=>new Intl.DateTimeFormat(D,{weekday:"short"}).format(new Date(Date.UTC(2e3,0,t))))}catch(a){console.error("Error generating calendar day names via Intl:",a)}let n=parseInt(e.getAttribute("data-tui-calendar-initial-month")),l=parseInt(e.getAttribute("data-tui-calendar-initial-year")),u=null;e.getAttribute("data-tui-calendar-selected-date")&&(u=E(e.getAttribute("data-tui-calendar-selected-date")));function E(a){if(!a)return null;try{let t=a.split("-"),i=parseInt(t[0],10),c=parseInt(t[1],10)-1,s=parseInt(t[2],10),o=new Date(Date.UTC(i,c,s));if(!isNaN(o)&&o.getUTCFullYear()===i&&o.getUTCMonth()===c&&o.getUTCDate()===s)return o}catch{}return null}function g(){let a=Math.max(0,Math.min(11,n)),i=`${C[a]} ${l}`;f.textContent=i}function S(){p.innerHTML="",I.forEach(a=>{let t=document.createElement("div");t.className="text-center text-xs text-muted-foreground font-medium",t.textContent=a,p.appendChild(t)})}function m(){y.innerHTML="";let i=new Date(Date.UTC(l,n,1)).getUTCDay(),c=new Date(Date.UTC(l,n+1,0)).getUTCDate(),s=new Date,o=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate()));for(let d=0;d<i;d++){let r=document.createElement("div");r.className="h-8 w-8",y.appendChild(r)}for(let d=1;d<=c;d++){let r=document.createElement("button");r.type="button",r.className="inline-flex h-8 w-8 items-center justify-center rounded-md text-sm font-medium focus:outline-none focus:ring-1 focus:ring-ring",r.textContent=d,r.dataset.day=d;let x=new Date(Date.UTC(l,n,d)),N=u&&x.getTime()===u.getTime(),F=x.getTime()===o.getTime();N?r.classList.add("bg-primary","text-primary-foreground","hover:bg-primary/90"):F?r.classList.add("bg-accent","text-accent-foreground"):r.classList.add("hover:bg-accent","hover:text-accent-foreground"),r.addEventListener("click",L),y.appendChild(r)}}function k(){n--,n<0&&(n=11,l--),g(),m()}function A(){n++,n>11&&(n=0,l++),g(),m()}function L(a){let t=parseInt(a.target.dataset.day);if(!t)return;let i=new Date(Date.UTC(l,n,t));u=i;let c=i.toISOString().split("T")[0];h.value=c,h.dispatchEvent(new Event("change",{bubbles:!0})),e.dispatchEvent(new CustomEvent("calendar-date-selected",{bubbles:!0,detail:{date:i}})),m()}b.addEventListener("click",k),v.addEventListener("click",A),g(),S(),m();let M=e.closest("form");M&&M.addEventListener("reset",()=>{u=null,h.value="",n=new Date().getMonth(),l=new Date().getFullYear(),g(),m()}),e._calendarInitialized=!0}function T(e=document){e instanceof Element&&e.matches("[data-tui-calendar-container]")&&w(e);for(let f of e.querySelectorAll("[data-tui-calendar-container]:not([data-initialized])"))w(f)}window.templUI=window.templUI||{},window.templUI.calendar={init:T},document.addEventListener("DOMContentLoaded",()=>T())})();})();
